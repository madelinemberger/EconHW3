---
title: "Econ HW3"
author: "Madeline Berger"
date: "5/16/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

survey <- read.csv("HW3Data.csv")


```


1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression coefficients.
```{r}

prob_lm <- lm(vote ~ age + income + NEP + bid + risk, data = survey)

summary(prob_lm)

y_int <- prob_lm$coefficients[1]
age50 <- prob_lm$coefficients[2]
age40 <- prob_lm$coefficients[3]
age60 <- prob_lm$coefficients[4]
age30 <- prob_lm$coefficients[5]
one_per <- prob_lm$coefficients[6]
poor <- prob_lm$coefficients[7]
rich <- prob_lm$coefficients[8]
veryrich <- prob_lm$coefficients[9]
nep <- prob_lm$coefficients[10]
bid <- prob_lm$coefficients[11]
risk <- prob_lm$coefficients[12]


```

**Linear Probability Model of Voting 'yes' on the ballot:**  
  
$Probability~of~Voting~Yes = (`r round(y_int, digits = 4)`) + (`r round(age30, digits=4)`)(age~to~30) + (`r round(age40, digits=4)`)(age~to~40) + (`r round(age50, digits=4)`)(age~to~50) + (`r round(age60, digits=4)`)(age~to~60) + (`r round(poor, digits=4)`)(income:~poor) + (`r round(rich, digits=4)`)(income:~rich) + (`r round(veryrich,digits=4)`)(income:~very~rich) +(`r round(one_per, digits=4)`)(income:~one~percent) +  (`r round(nep, digits=4)`)(NEP) + (`r round(bid, digits=4)`)(bid) + (`r round(risk, digits=4)`)(risk~reduction)$


2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)
```{r}


```


3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction.
```{r}

```


4. Now repeat this process and estimate the mean WTP for a VSR program offering 60% risk reduction among Santa Barbara County households.
```{r}

```


5. If there are 150,000 households in Santa Barbara County, estimate the total benefit of a VSR program to these households.
```{r}

```


6. Based only on these benefits, do the benefits of the VSR program outweigh the costs?
```{r}

```

