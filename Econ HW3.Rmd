---
title: "Econ HW3"
author: "Madeline Berger"
date: "5/16/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

survey <- read.csv("HW3Data.csv")

counts <- survey %>% 
  count(income)

counts

counts2<-survey %>% 
  count(age)

counts2




```

mode income : one percent

mode age: tothirty


###1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression coefficients.
```{r include=FALSE, echo=FALSE}

prob_lm <- lm(vote ~ age + income + NEP + bid + risk, data = survey)

summary(prob_lm)

y_int <- prob_lm$coefficients[1]
age50 <- prob_lm$coefficients[2]
age40 <- prob_lm$coefficients[3]
age60 <- prob_lm$coefficients[4]
age30 <- prob_lm$coefficients[5]
one_per <- prob_lm$coefficients[6]
poor <- prob_lm$coefficients[7]
rich <- prob_lm$coefficients[8]
veryrich <- prob_lm$coefficients[9]
nep <- prob_lm$coefficients[10]
bid <- prob_lm$coefficients[11]
risk <- prob_lm$coefficients[12]


```

**Linear Probability Model of Voting 'yes' on the ballot:**  
  
$Probability~of~Voting~Yes = (`r round(y_int, digits = 4)`) + (`r round(age30, digits=4)`)(age~to~30) + (`r round(age40, digits=4)`)(age~to~40) + (`r round(age50, digits=4)`)(age~to~50) + (`r round(age60, digits=4)`)(age~to~60) + (`r round(poor, digits=4)`)(income:~poor) + (`r round(rich, digits=4)`)(income:~rich) + (`r round(veryrich,digits=4)`)(income:~very~rich) +(`r round(one_per, digits=4)`)(income:~one~percent) +  (`r round(nep, digits=4)`)(NEP) + (`r round(bid, digits=4)`)(bid) + (`r round(risk, digits=4)`)(risk~reduction)$

####1a. Defining the function 

```{r}

#a = are they over 50, 1 if yes 0 if no
#r= are the rich
#p = are they poor
#v= are the very rich
#o = are they part of the one percent
#n = nep
#b = bid
#x = risk level


p_yes_50 <- function(a,r,p,v,o,n,b,x){
  y_int + age50*a+1*r+poor*p+one_per*o+veryrich*v+nep*n+bid*b+risk*x


```



####2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)


If a 20% risk reduction saves 5 whales, then we can find that a 4% reduction will save one whale. Therefore, we can solve for the change in bid (used as a proxy for willingness to pay) for an additional 4% risk reduction.
```{r include= FALSE, include= FALSE}
#Step 1: Find the coefficient for bid when risk is 0%
#Inputs:
#probability of voting yes = 0.5
#age = 30
#income = rich 
#NEP = 34


bid_0 <- (0.5- y_int - age30*1 - one_per*1 - nep*34 - risk*0)/bid

bid_4 <- (0.5- y_int - age30*1 - one_per*1 - nep*34 - risk*4)/bid

diff = bid_4-bid_0

```
The per person willingness to pay for a single whale is **$2.78**.



####3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction.

```{r include=FALSE, echo=FALSE}
#choose three random respondents from the table 
#plug in their values, and solve for bid
#number in bid_x corresponds to row
##########################################

#Individual 110

bid_110 <- (0.5- y_int - age30*1 - rich*1 - nep*36 - risk*60)/bid

#Individual 27

bid_27 <- (0.5- y_int - age30*1 - one_per*1 - nep*44 - risk*60)/bid

#Individual 54

bid_54 <- (0.5- y_int - age30*1 - nep*48 - risk*60)/bid

```



####4. Now repeat this process and estimate the **mean WTP** for a VSR program offering 60% risk reduction among Santa Barbara County households.
```{r include=FALSE, echo=FALSE}


avg_nep <- mean(survey$NEP)
avg_income<- mode(survey$income)
avg_age<-mode(survey$age)

bid_60 <- (0.5- y_int - age30*1 - rich*1 - nep*34 - risk*0)/bid


```
Average NEP is calculated as 38.366, whereas average income bracket is found to be .. and the average age bracket found to be ....
Again, the probability of saying "yes" is taken as 0.5. Using average age, average income,and the average NEP, the willingness to pay is calculated as:

$ 0.5 = `r round(y_int, digits = 4)` + `r round(age50, digits=4)`(age~to~50) + `r round(nep, digits=4)`(NEP) - `r round(bid, digits=4)`(bid) + `r round(risk, digits=4)`(60)$  



####5. If there are 150,000 households in Santa Barbara County, estimate the total benefit of a VSR program to these households.
```{r include=FALSE, echo=FALSE}

```


####6. Based only on these benefits, do the benefits of the VSR program outweigh the costs?
```{r include= FALSE, echo=FALSE}

```

